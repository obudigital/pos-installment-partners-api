<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1538px" preserveAspectRatio="none" style="width:1102px;height:1538px;background:#FFFFFF;" version="1.1" viewBox="0 0 1102 1538" width="1102px" zoomAndPan="magnify"><defs><filter height="300%" id="f197w5dn32a46k" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="206" x="444.5" y="29.4023">OTP Partner Installment</text><rect fill="#FFFFFF" filter="url(#f197w5dn32a46k)" height="648.4551" style="stroke:#000000;stroke-width:2.0;" width="1075" x="10" y="140.6875"/><rect fill="#FFFFFF" filter="url(#f197w5dn32a46k)" height="488.2578" style="stroke:#000000;stroke-width:2.0;" width="1019" x="56" y="293.8848"/><rect fill="#FFFFFF" filter="url(#f197w5dn32a46k)" height="159.5078" style="stroke:#000000;stroke-width:2.0;" width="567.5" x="66" y="429.127"/><rect fill="#FFFFFF" height="73.5762" style="stroke:none;stroke-width:1.0;" width="567.5" x="66" y="515.0586"/><rect fill="#FFFFFF" height="186.5078" style="stroke:none;stroke-width:1.0;" width="1019" x="56" y="595.6348"/><rect fill="#FFFFFF" filter="url(#f197w5dn32a46k)" height="46.6211" style="stroke:#000000;stroke-width:2.0;" width="567.5" x="66" y="689.2109"/><rect fill="#FFFFFF" filter="url(#f197w5dn32a46k)" height="115.2422" style="stroke:#000000;stroke-width:2.0;" width="617" x="66" y="803.1426"/><rect fill="#FFFFFF" filter="url(#f197w5dn32a46k)" height="463.3027" style="stroke:#000000;stroke-width:2.0;" width="627.5" x="36" y="973.3398"/><rect fill="#FFFFFF" filter="url(#f197w5dn32a46k)" height="319.1055" style="stroke:#000000;stroke-width:2.0;" width="607.5" x="46" y="997.6504"/><rect fill="#FFFFFF" filter="url(#f197w5dn32a46k)" height="146.5527" style="stroke:#000000;stroke-width:2.0;" width="587.5" x="56" y="1163.2031"/><rect fill="#FFFFFF" filter="url(#f197w5dn32a46k)" height="115.2422" style="stroke:#000000;stroke-width:2.0;" width="567.5" x="66" y="1187.5137"/><rect fill="#FFFFFF" height="112.8867" style="stroke:none;stroke-width:1.0;" width="627.5" x="36" y="1323.7559"/><line style="stroke:#A80036;stroke-width:1.0;" x1="43" x2="43" y1="123.6875" y2="216.6191"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="43" x2="43" y1="216.6191" y2="257.5742"/><line style="stroke:#A80036;stroke-width:1.0;" x1="43" x2="43" y1="257.5742" y2="925.3848"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="43" x2="43" y1="925.3848" y2="966.3398"/><line style="stroke:#A80036;stroke-width:1.0;" x1="43" x2="43" y1="966.3398" y2="1453.6426"/><line style="stroke:#A80036;stroke-width:1.0;" x1="110" x2="110" y1="123.6875" y2="216.6191"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="110" x2="110" y1="216.6191" y2="257.5742"/><line style="stroke:#A80036;stroke-width:1.0;" x1="110" x2="110" y1="257.5742" y2="925.3848"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="110" x2="110" y1="925.3848" y2="966.3398"/><line style="stroke:#A80036;stroke-width:1.0;" x1="110" x2="110" y1="966.3398" y2="1453.6426"/><line style="stroke:#A80036;stroke-width:1.0;" x1="569.5" x2="569.5" y1="123.6875" y2="216.6191"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="569.5" x2="569.5" y1="216.6191" y2="257.5742"/><line style="stroke:#A80036;stroke-width:1.0;" x1="569.5" x2="569.5" y1="257.5742" y2="925.3848"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="569.5" x2="569.5" y1="925.3848" y2="966.3398"/><line style="stroke:#A80036;stroke-width:1.0;" x1="569.5" x2="569.5" y1="966.3398" y2="1453.6426"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1001" x2="1001" y1="123.6875" y2="216.6191"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1001" x2="1001" y1="216.6191" y2="257.5742"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1001" x2="1001" y1="257.5742" y2="925.3848"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1001" x2="1001" y1="925.3848" y2="966.3398"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1001" x2="1001" y1="966.3398" y2="1453.6426"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="20" y="120.7344">Client</text><ellipse cx="43" cy="50.1992" fill="#FEFECE" filter="url(#f197w5dn32a46k)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M43,58.1992 L43,85.1992 M30,66.1992 L56,66.1992 M43,85.1992 L30,100.1992 M43,85.1992 L56,100.1992 " fill="none" filter="url(#f197w5dn32a46k)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="20" y="1466.1777">Client</text><ellipse cx="43" cy="1479.1309" fill="#FEFECE" filter="url(#f197w5dn32a46k)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M43,1487.1309 L43,1514.1309 M30,1495.1309 L56,1495.1309 M43,1514.1309 L30,1529.1309 M43,1514.1309 L56,1529.1309 " fill="none" filter="url(#f197w5dn32a46k)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#f197w5dn32a46k)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="64" x="76" y="88.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="83" y="108.7344">Partner</text><rect fill="#FEFECE" filter="url(#f197w5dn32a46k)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="64" x="76" y="1452.6426"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="83" y="1473.1777">Partner</text><rect fill="#FEFECE" filter="url(#f197w5dn32a46k)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="103" x="516.5" y="88.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89" x="523.5" y="108.7344">OTP Backend</text><rect fill="#FEFECE" filter="url(#f197w5dn32a46k)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="103" x="516.5" y="1452.6426"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89" x="523.5" y="1473.1777">OTP Backend</text><rect fill="#FEFECE" filter="url(#f197w5dn32a46k)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="124" x="937" y="88.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="944" y="108.7344">OTP Mobile App</text><rect fill="#FEFECE" filter="url(#f197w5dn32a46k)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="124" x="937" y="1452.6426"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="944" y="1473.1777">OTP Mobile App</text><path d="M10,140.6875 L178,140.6875 L178,147.6875 L168,157.6875 L10,157.6875 L10,140.6875 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="648.4551" style="stroke:#000000;stroke-width:2.0;" width="1075" x="10" y="140.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="123" x="25" y="154.2559">Решение клиента</text><polygon fill="#A80036" points="989,175.3086,999,179.3086,989,183.3086,993,179.3086" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="570" x2="995" y1="179.3086" y2="179.3086"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="577" y="174.5664">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="590" y="174.5664">Push Notification</text><polygon fill="#A80036" points="54,204.6191,44,208.6191,54,212.6191,50,208.6191" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="48" x2="1000" y1="208.6191" y2="208.6191"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="60" y="203.877">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="39" x="73" y="203.877">Sound</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="87" x="478.5" y="241.2539">Минутой спустя</text><polygon fill="#A80036" points="989,274.8848,999,278.8848,989,282.8848,993,278.8848" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="43" x2="995" y1="278.8848" y2="278.8848"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="50" y="274.1426">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55" x="63" y="274.1426">Decision</text><path d="M56,293.8848 L118,293.8848 L118,300.8848 L108,310.8848 L56,310.8848 L56,293.8848 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="488.2578" style="stroke:#000000;stroke-width:2.0;" width="1019" x="56" y="293.8848"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="71" y="307.4531">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="262" x="133" y="306.5195">[Подтверждения намерения взять рассрочку]</text><polygon fill="#A80036" points="581,328.5059,571,332.5059,581,336.5059,577,332.5059" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="575" x2="1000" y1="332.5059" y2="332.5059"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="587" y="327.7637">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="600" y="327.7637">Клиент подтверждает</text><line style="stroke:#A80036;stroke-width:1.0;" x1="570" x2="612" y1="361.8164" y2="361.8164"/><line style="stroke:#A80036;stroke-width:1.0;" x1="612" x2="612" y1="361.8164" y2="374.8164"/><line style="stroke:#A80036;stroke-width:1.0;" x1="571" x2="612" y1="374.8164" y2="374.8164"/><polygon fill="#A80036" points="581,370.8164,571,374.8164,581,378.8164,577,374.8164" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="577" y="357.0742">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="404" x="590" y="357.0742">Решение банка на основе текущего остатка лимита рассрочки.</text><path d="M311,387.8164 L311,412.8164 L561,412.8164 L561,397.8164 L551,387.8164 L311,387.8164 " fill="#FBFB77" filter="url(#f197w5dn32a46k)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M551,387.8164 L551,397.8164 L561,397.8164 L551,387.8164 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229" x="317" y="405.3848">Произойдет блокирование средств</text><path d="M66,429.127 L128,429.127 L128,436.127 L118,446.127 L66,446.127 L66,429.127 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="159.5078" style="stroke:#000000;stroke-width:2.0;" width="567.5" x="66" y="429.127"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="81" y="442.6953">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="221" x="143" y="441.7617">[Партнером запрошен callback вызов]</text><path d="M264,451.4375 L264,476.4375 L561,476.4375 L561,461.4375 L551,451.4375 L264,451.4375 " fill="#FBFB77" filter="url(#f197w5dn32a46k)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M551,451.4375 L551,461.4375 L561,461.4375 L551,451.4375 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="276" x="270" y="469.0059">Узнать о положительном решении клиента</text><polygon fill="#A80036" points="121,503.0586,111,507.0586,121,511.0586,117,507.0586" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="115" x2="569" y1="507.0586" y2="507.0586"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="127" y="502.3164">6</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="197" x="140" y="502.3164">POST $onSuccessCallbackURI</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="66" x2="633.5" y1="516.0586" y2="516.0586"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="30" x="71" y="526.6934">[pull]</text><polygon fill="#A80036" points="558,547.3242,568,551.3242,558,555.3242,562,551.3242" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="110" x2="564" y1="551.3242" y2="551.3242"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="117" y="546.582">7</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="337" x="130" y="546.582">GET /partner/installments/orders/{orderid}/state</text><polygon fill="#A80036" points="121,576.6348,111,580.6348,121,584.6348,117,580.6348" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="115" x2="569" y1="580.6348" y2="580.6348"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="127" y="575.8926">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="140" y="575.8926">200 OK</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="56" x2="1075" y1="596.6348" y2="596.6348"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="42" x="61" y="607.2695">[Отказ]</text><polygon fill="#A80036" points="581,627.9004,571,631.9004,581,635.9004,577,631.9004" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="575" x2="1000" y1="631.9004" y2="631.9004"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="587" y="627.1582">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="600" y="627.1582">Клиент отказывается</text><line style="stroke:#A80036;stroke-width:1.0;" x1="570" x2="612" y1="661.2109" y2="661.2109"/><line style="stroke:#A80036;stroke-width:1.0;" x1="612" x2="612" y1="661.2109" y2="674.2109"/><line style="stroke:#A80036;stroke-width:1.0;" x1="571" x2="612" y1="674.2109" y2="674.2109"/><polygon fill="#A80036" points="581,670.2109,571,674.2109,581,678.2109,577,674.2109" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="577" y="656.4688">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="599" y="656.4688">Разблокировать средства</text><path d="M66,689.2109 L128,689.2109 L128,696.2109 L118,706.2109 L66,706.2109 L66,689.2109 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="46.6211" style="stroke:#000000;stroke-width:2.0;" width="567.5" x="66" y="689.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="81" y="702.7793">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="221" x="143" y="701.8457">[Партнером запрошен callback вызов]</text><ellipse cx="109.5" cy="727.082" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;fill:none;"/><polygon fill="#A80036" points="126.5,723.832,116.5,727.832,126.5,731.832,122.5,727.832" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="124.5" x2="569" y1="727.832" y2="727.832"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="127" y="723.0898">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="149" y="723.0898">POST $onFailCallbackURI</text><path d="M232,747.832 L232,772.832 L561,772.832 L561,757.832 L551,747.832 L232,747.832 " fill="#FBFB77" filter="url(#f197w5dn32a46k)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M551,747.832 L551,757.832 L561,757.832 L551,747.832 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="308" x="238" y="765.4004">Уведомить об отрицательном решении клиента</text><path d="M66,803.1426 L678,803.1426 L678,810.1426 L668,820.1426 L66,820.1426 L66,803.1426 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="115.2422" style="stroke:#000000;stroke-width:2.0;" width="617" x="66" y="803.1426"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="567" x="81" y="816.7109">Завершение создания (все стороны получили необходимое для выдачи товаров)</text><polygon fill="#A80036" points="558,837.7637,568,841.7637,558,845.7637,562,841.7637" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="110" x2="564" y1="841.7637" y2="841.7637"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="117" y="837.0215">12</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="414" x="139" y="837.0215">GET /partner/installments/orders/{orderid}/guaranteeLetter</text><path d="M253,854.7637 L253,879.7637 L561,879.7637 L561,864.7637 L551,854.7637 L253,854.7637 " fill="#FBFB77" filter="url(#f197w5dn32a46k)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M551,854.7637 L551,864.7637 L561,864.7637 L551,854.7637 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="287" x="259" y="872.332">Получить подписанное гарантийное письмо</text><polygon fill="#A80036" points="121,906.3848,111,910.3848,121,914.3848,117,910.3848" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="115" x2="569" y1="910.3848" y2="910.3848"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="127" y="905.6426">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="238" x="149" y="905.6426">200 письмо в формате XML или JSON</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="262" x="391" y="950.0195">На кассе сразу или днями позже через доставку</text><path d="M36,973.3398 L98,973.3398 L98,980.3398 L88,990.3398 L36,990.3398 L36,973.3398 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="463.3027" style="stroke:#000000;stroke-width:2.0;" width="627.5" x="36" y="973.3398"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="51" y="986.9082">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="194" x="113" y="985.9746">[Партнер может отгрузить товар]</text><path d="M46,997.6504 L534,997.6504 L534,1004.6504 L524,1014.6504 L46,1014.6504 L46,997.6504 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="319.1055" style="stroke:#000000;stroke-width:2.0;" width="607.5" x="46" y="997.6504"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="443" x="61" y="1011.2188">Передача товара и перевод блокировки в активную рассрочку</text><ellipse cx="569.5" cy="1035.5215" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;fill:none;"/><polygon fill="#A80036" points="552.5,1032.2715,562.5,1036.2715,552.5,1040.2715,556.5,1036.2715" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="110" x2="558.5" y1="1036.2715" y2="1036.2715"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="117" y="1031.5293">14</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="381" x="139" y="1031.5293">POST /partner/installments/orders/{orderid}/state/sent</text><path d="M115,1049.2715 L115,1074.2715 L362,1074.2715 L362,1059.2715 L352,1049.2715 L115,1049.2715 " fill="#FBFB77" filter="url(#f197w5dn32a46k)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M352,1049.2715 L352,1059.2715 L362,1059.2715 L352,1049.2715 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="226" x="121" y="1066.8398">Уведомить банк о передаче товара</text><ellipse cx="109.5" cy="1104.1426" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;fill:none;"/><polygon fill="#A80036" points="126.5,1100.8926,116.5,1104.8926,126.5,1108.8926,122.5,1104.8926" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="124.5" x2="569" y1="1104.8926" y2="1104.8926"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="127" y="1100.1504">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="149" y="1100.1504">200 OK</text><rect fill="#EEEEEE" filter="url(#f197w5dn32a46k)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1095" x="0" y="1133.5479"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1095" y1="1133.5479" y2="1133.5479"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1095" y1="1136.5479" y2="1136.5479"/><rect fill="#EEEEEE" filter="url(#f197w5dn32a46k)" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="125" x="485" y="1122.8926"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="107" x="491" y="1139.4609">Возврат товара</text><path d="M56,1163.2031 L118,1163.2031 L118,1170.2031 L108,1180.2031 L56,1180.2031 L56,1163.2031 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="146.5527" style="stroke:#000000;stroke-width:2.0;" width="587.5" x="56" y="1163.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="71" y="1176.7715">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="97" x="133" y="1175.8379">[Возврат товара]</text><path d="M66,1187.5137 L140,1187.5137 L140,1194.5137 L130,1204.5137 L66,1204.5137 L66,1187.5137 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="115.2422" style="stroke:#000000;stroke-width:2.0;" width="567.5" x="66" y="1187.5137"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="81" y="1201.082">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="192" x="155" y="1200.1484">[Пока есть товары для возврата]</text><polygon fill="#A80036" points="558,1222.1348,568,1226.1348,558,1230.1348,562,1226.1348" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="110" x2="564" y1="1226.1348" y2="1226.1348"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="117" y="1221.3926">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="378" x="139" y="1221.3926">POST /partner/installments/orders/{orderid}/state/returned</text><path d="M115,1239.1348 L115,1264.1348 L358,1264.1348 L358,1249.1348 L348,1239.1348 L115,1239.1348 " fill="#FBFB77" filter="url(#f197w5dn32a46k)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M348,1239.1348 L348,1249.1348 L358,1249.1348 L348,1239.1348 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222" x="121" y="1256.7031">Уведомить банк о возврате товара</text><polygon fill="#A80036" points="121,1290.7559,111,1294.7559,121,1298.7559,117,1294.7559" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="115" x2="569" y1="1294.7559" y2="1294.7559"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="127" y="1290.0137">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="149" y="1290.0137">200 OK</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="36" x2="663.5" y1="1324.7559" y2="1324.7559"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="307" x="41" y="1335.3906">[Партнер не может выдать товар и отменяет сделку]</text><ellipse cx="569.5" cy="1359.2715" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;fill:none;"/><polygon fill="#A80036" points="552.5,1356.0215,562.5,1360.0215,552.5,1364.0215,556.5,1360.0215" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="110" x2="558.5" y1="1360.0215" y2="1360.0215"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="117" y="1355.2793">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="384" x="139" y="1355.2793">POST /partner/installments/orders/{orderid}/state/cancelled</text><path d="M115,1373.0215 L115,1398.0215 L554,1398.0215 L554,1383.0215 L544,1373.0215 L115,1373.0215 " fill="#FBFB77" filter="url(#f197w5dn32a46k)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M544,1373.0215 L544,1383.0215 L554,1383.0215 L544,1373.0215 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="418" x="121" y="1390.5898">Уведомить банк о б отмене сделки. Банк разблокирует средства</text><ellipse cx="109.5" cy="1427.8926" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;fill:none;"/><polygon fill="#A80036" points="126.5,1424.6426,116.5,1428.6426,126.5,1432.6426,122.5,1428.6426" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="124.5" x2="569" y1="1428.6426" y2="1428.6426"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="127" y="1423.9004">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="149" y="1423.9004">200 OK</text><!--MD5=[67a5beafb1a2290a24a9883ac3d69169]
@startuml pos-installment-partners-api
title: OTP Partner Installment

actor Client as C
participant "Partner" as P
participant "OTP Backend" as B
participant "OTP Mobile App" as A

autonumber

'C -> A: open app

group Решение клиента

    B -> A : Push Notification
    A -> C : Sound

    ...Минутой спустя...

    C -> A : Decision

    alt Подтверждения намерения взять рассрочку
        A -> B : Клиент подтверждает
        ' есть ли средства
        ' alt не хватило средств
        B -> B : Решение банка на основе текущего остатка лимита рассрочки.
        note left of B
        Произойдет блокирование средств
        end note

        alt Партнером запрошен callback вызов
            note left of B
            Узнать о положительном решении клиента
            end note
            B -> P : <b>POST $onSuccessCallbackURI</b>
        else pull
            P -> B : <b>GET /partner/installments/orders/{orderid}/state</b>
            return 200 OK
        end

    else Отказ

        A -> B : Клиент отказывается
        B -> B : Разблокировать средства
        alt Партнером запрошен callback вызов
        B ->o P : POST $onFailCallbackURI
        end
        note left of B
        Уведомить об отрицательном решении клиента
        end note

    end



end

group Завершение создания (все стороны получили необходимое для выдачи товаров)

    P -> B : <b>GET /partner/installments/orders/{orderid}/guaranteeLetter</b>
    note left of B
    Получить подписанное гарантийное письмо
    end note
    return 200 письмо в формате XML или JSON

end


...На кассе сразу или днями позже через доставку...


alt Партнер может отгрузить товар

    group Передача товара и перевод блокировки в активную рассрочку

        P ->o B : <b>POST /partner/installments/orders/{orderid}/state/sent</b>
        note right of P
        Уведомить банк о передаче товара
        end note
        return 200 OK
        ' рассрочка активна

== Возврат товара ==

alt Возврат товара
    loop Пока есть товары для возврата

    P -> B : POST /partner/installments/orders/{orderid}/state/returned
    note right of P
    Уведомить банк о возврате товара
    end note
    return 200 OK

    end
end


    end

else Партнер не может выдать товар и отменяет сделку
    ' P cancelled

    P ->o B : POST /partner/installments/orders/{orderid}/state/cancelled
    note right of P
    Уведомить банк о б отмене сделки. Банк разблокирует средства
    end note
    return 200 OK

end


' any time - reports, turnover

@enduml

@startuml pos-installment-partners-api
title: OTP Partner Installment

actor Client as C
participant "Partner" as P
participant "OTP Backend" as B
participant "OTP Mobile App" as A

autonumber


group Решение клиента

    B -> A : Push Notification
    A -> C : Sound

    ...Минутой спустя...

    C -> A : Decision

    alt Подтверждения намерения взять рассрочку
        A -> B : Клиент подтверждает
        B -> B : Решение банка на основе текущего остатка лимита рассрочки.
        note left of B
        Произойдет блокирование средств
        end note

        alt Партнером запрошен callback вызов
            note left of B
            Узнать о положительном решении клиента
            end note
            B -> P : <b>POST $onSuccessCallbackURI</b>
        else pull
            P -> B : <b>GET /partner/installments/orders/{orderid}/state</b>
            return 200 OK
        end

    else Отказ

        A -> B : Клиент отказывается
        B -> B : Разблокировать средства
        alt Партнером запрошен callback вызов
        B ->o P : POST $onFailCallbackURI
        end
        note left of B
        Уведомить об отрицательном решении клиента
        end note

    end



end

group Завершение создания (все стороны получили необходимое для выдачи товаров)

    P -> B : <b>GET /partner/installments/orders/{orderid}/guaranteeLetter</b>
    note left of B
    Получить подписанное гарантийное письмо
    end note
    return 200 письмо в формате XML или JSON

end


...На кассе сразу или днями позже через доставку...


alt Партнер может отгрузить товар

    group Передача товара и перевод блокировки в активную рассрочку

        P ->o B : <b>POST /partner/installments/orders/{orderid}/state/sent</b>
        note right of P
        Уведомить банк о передаче товара
        end note
        return 200 OK

== Возврат товара ==

alt Возврат товара
    loop Пока есть товары для возврата

    P -> B : POST /partner/installments/orders/{orderid}/state/returned
    note right of P
    Уведомить банк о возврате товара
    end note
    return 200 OK

    end
end


    end

else Партнер не может выдать товар и отменяет сделку

    P ->o B : POST /partner/installments/orders/{orderid}/state/cancelled
    note right of P
    Уведомить банк о б отмене сделки. Банк разблокирует средства
    end note
    return 200 OK

end



@enduml

PlantUML version 1.2021.7(Sun May 23 15:40:07 EEST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: GB
--></g></svg>